<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Focus | Daily Tracker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div class="container">
        <div id="auth-screen" class="screen visible">
            <div class="glass-card auth-container">
                <h2>Focus Tracker</h2>
                <div id="auth-error" class="error-msg"></div>
                <input type="email" id="email" placeholder="Email">
                <input type="password" id="password" placeholder="Password">
                <button class="primary" onclick="handleAuth()">Sign In</button>
                <div style="margin-top:16px; cursor:pointer; color:var(--text-secondary)" onclick="toggleAuthMode()"
                    id="auth-toggle-text">Need an account? Sign Up</div>
            </div>
        </div>

        <div id="app-screen" class="screen">
            <div class="glass-card">
                <div class="app-header">
                    <div class="brand-title">Focus</div>
                    <div class="header-actions">
                        <button class="icon-btn" onclick="openStats()">
                            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path
                                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                            </svg>
                        </button>
                        <div class="logout-text" onclick="signOut()">Sign Out</div>
                    </div>
                </div>

                <div class="day-controller">
                    <span class="date-label" id="current-date-display">...</span>
                    <select id="day-override" class="day-select" onchange="changeDayMode()">
                        <option value="0">Monday</option>
                        <option value="1">Tuesday</option>
                        <option value="2">Wednesday</option>
                        <option value="3">Thursday</option>
                        <option value="4">Friday</option>
                        <option value="5">Saturday</option>
                        <option value="6">Sunday</option>
                    </select>
                </div>

                <div class="progress-container" id="progress-container">
                    <div class="progress-header">
                        <span class="progress-label">Today's Progress</span>
                        <span class="progress-percent" id="progress-percent">0%</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div class="habit-list" id="habit-list"></div>

                <div class="add-section">
                    <div class="detail-label">New Routine Item</div>
                    <input type="text" id="new-habit-text" placeholder="e.g. 30min Running">
                    <div class="week-selector" id="day-toggles">
                        <button class="day-btn" data-day="0">M</button>
                        <button class="day-btn" data-day="1">T</button>
                        <button class="day-btn" data-day="2">W</button>
                        <button class="day-btn" data-day="3">T</button>
                        <button class="day-btn" data-day="4">F</button>
                        <button class="day-btn" data-day="5">S</button>
                        <button class="day-btn" data-day="6">S</button>
                    </div>
                    <button class="primary" onclick="addHabit()">Add to Schedule</button>
                </div>
            </div>
        </div>

        <div id="stats-modal" class="modal-overlay">
            <div class="modal-card">
                <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                    <h3>Progress Overview</h3>
                    <button class="icon-btn" onclick="closeStats()">âœ•</button>
                </div>

                <div class="stats-tabs">
                    <button class="tab-btn active" onclick="switchTab('week')" id="tab-week">Week</button>
                    <button class="tab-btn" onclick="switchTab('month')" id="tab-month">Month</button>
                    <button class="tab-btn" onclick="switchTab('year')" id="tab-year">Year</button>
                </div>

                <div id="stats-content">
                </div>

                <button class="secondary" onclick="exportData()">
                    <svg style="vertical-align:middle; margin-right:6px;" width="16" height="16" fill="none"
                        stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    Export Data (JSON)
                </button>
            </div>
        </div>
    </div>
    <template id="habit-card-template">
        <div class="habit-card">
            <div class="habit-header">
                <div class="habit-main">
                    <div class="checkbox">
                        <svg class="check-icon" width="16" height="16" stroke="white" stroke-width="3" fill="none"
                            viewBox="0 0 24 24" style="display: none;">
                            <path d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <span class="habit-title"></span>
                    <span class="streak-container"></span>
                </div>
                <div class="log-indicator" title="">
                    <span class="log-dot note" title="Note"></span>
                    <span class="log-dot photo" title="Photo"></span>
                </div>
                <button class="action-btn">
                    <span class="btn-text">Log</span>
                    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path
                            d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                    </svg>
                </button>
            </div>
            <div class="habit-details">
                <label class="detail-label">Note / Alternative Activity:</label>
                <textarea class="detail-textarea" rows="2" placeholder="Did you do something else?"></textarea>

                <label class="detail-label">Evidence (Photo):</label>
                <div class="upload-box">
                    <span class="upload-hint">Click to Upload Image</span>
                    <input type="file" hidden accept="image/*" class="file-input">
                    <img class="preview-img">
                </div>

                <button class="delete-btn">
                    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path
                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Delete Routine Permanently
                </button>
            </div>
        </div>
    </template>

    <template id="streak-badge-template">
        <span class="streak-badge">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M12 23c-3.03 0-6-1.68-6-6 0-2.12 1.2-4.17 2.4-5.83l1.2-1.47c0-.36.1-.91.1-1.4 0-1-.3-2.4-.3-3.6 0-1.1.4-2.2 1.1-3.1.3-.4.9-.5 1.3-.2.3.3.5.8.3 1.2-.5 1.5-.1 3.1 1 4.2.9.9 2.3 1.5 3.7 1.5 1.4.1 2.3.5 3.2 1.3.8.8 1.1 1.7 1.1 2.7 0 .8-.2 1.5-.5 2.2C19.5 18.1 16.84 23 12 23z" />
            </svg>
            <span class="streak-text"></span>
        </span>
    </template>

    <template id="stats-summary-template">
        <div class="stat-summary">
            <div class="stat-box">
                <div class="stat-value total-done"></div>
                <div class="stat-label">Total Done</div>
            </div>
            <div class="stat-box">
                <div class="stat-value best-streak"></div>
                <div class="stat-label">Best Streak</div>
            </div>
            <div class="stat-box">
                <div class="stat-value active-days"></div>
                <div class="stat-label">Active Days</div>
            </div>
        </div>
    </template>

    <script src="app.js"></script>
</body>

</html>